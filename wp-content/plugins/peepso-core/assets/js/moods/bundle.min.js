!function(a,b){var c=function(a){function b(){this.__constructor.apply(this,arguments)}var c=a("#mood-text-string").text(),d=!1,e=".ps-postbox-moods";return b.prototype={__constructor:function(b){this.postbox=b,this.$doc=a(document),this.$toggle=b.$tabContext.find("#mood-tab"),this.$dropdown=b.$tabContext.find(".ps-js-postbox-mood"),this.$remove=this.$dropdown.find("button"),this.$toggle.on("click"+e,a.proxy(this.toggle,this)),this.$dropdown.on("click"+e,".mood-list",a.proxy(this.select,this)),this.$remove.on("click"+e,a.proxy(this.remove,this)),this._mapMoods(),b.add_action("update",this.update,10,2,this),b.add_filter("render_addons",this.render,10,1,this),b.add_filter("data",this.filterData,10,1,this),b.add_filter("data_validate",this.validate,10,2,this)},show:function(){this.$dropdown.show(),this.$doc.on("click"+e,a.proxy(this.onDocumentClick,this))},hide:function(){this.$dropdown.hide(),this.$doc.off("click"+e)},toggle:function(){this.$dropdown.is(":visible")?this.hide():this.show()},filterData:function(a){return this._selected?a.mood=this._selected.value:a.mood="",a},validate:function(a,b){return!!this._selected||a},select:function(b){var c=a(b.currentTarget);c.length&&(this._selected={value:c.data("option-value"),label:c.data("option-display-value"),className:c.find("i").attr("class")},this.$remove.show(),this.postbox.do_action("refresh"))},remove:function(){this._selected=!1,this.$remove.hide(),this.postbox.do_action("refresh")},update:function(a){a=a&&a.data||{},a.mood?(this._selected={value:a.mood,label:d[a.mood].label,className:d[a.mood].icon},this.$remove.show()):(this._selected=!1,this.$remove.hide()),this.postbox.do_action("refresh")},render:function(a){var b;return this._selected&&(b='<i class="'+this._selected.className+'"></i>',b+="<b> "+c+this._selected.label+"</b>",a.push(b)),a},_mapMoods:function(){var b;d||(b=this.$dropdown.find("a.mood-list"),b.each(function(){var b=a(this),c=b.find("i"),e=b.data("option-value"),f=b.data("option-display-value"),g=c.attr("class");d||(d={}),d[e]={icon:g,label:f}}))},onDocumentClick:function(b){a(b.target).closest(this.$toggle).length||this.hide()}},b}(a);ps_observer.add_action("postbox_init",function(a){new c(a)},10,1)}(jQuery),function(a,b,c){!function(a,b){function c(){this.$postbox=null,this.$mood=null,this.$mood_remove=null,this.$mood_dropdown_toggle=null,this.mood_selected=!1,this.can_submit=!1}c.prototype.set_postbox=function(a){this.$postbox=a},c.prototype.init=function(){if(!_.isUndefined(this.$postbox)){var a=this;ps_observer.add_filter("peepso_postbox_can_submit",function(b){return b.soft.push(a.can_submit),b},20,1),this.$mood=jQuery("#postbox-mood",this.$postbox),this.$mood_dropdown_toggle=jQuery("#mood-tab .interaction-icon-wrapper > a",this.$postbox),this.$mood_remove=jQuery("#postbox-mood-remove",this.$postbox),this.$mood.on("click","a.mood-list",function(b){a.select_mood(b)}),this.$mood_remove.on("click",function(){a.remove_mood()}),this.$mood_dropdown_toggle.on("click",function(){a.$mood.toggle()}),this.$mood_dropdown_toggle.on("peepso.interaction-hide",function(){a.$mood.hide()}),jQuery(document).on("click",function(b){var c=jQuery("#mood-tab",a.$postbox);c.is(b.target)||0!==c.has(b.target).length||a.$mood.hide()}),this.$postbox.on("postbox.post_cancel postbox.post_saved",function(){a.remove_mood()}),ps_observer.add_filter("postbox_req_"+this.$postbox.guid,function(b){return a.set_mood(b)},10,1),ps_observer.add_filter("peepso_postbox_addons_update",function(b){var c,d;return a.mood_selected&&(c=a.mood_selected,d='<i class="ps-emoticon '+c[0]+'"></i> <b>'+c[1]+"</b>",b.push(d)),b},10,1)}},c.prototype.select_mood=function(a){var b=jQuery(a.target).closest("a"),c=jQuery("#mood-tab",this.$postbox),d=jQuery("#postbox-mood-input",this.$postbox),e=(c.find("a"),b.closest("#postbox-mood")),f=(this.$postbox.$textarea.parent(),b.find("i").attr("class")),g=jQuery("#mood-text-string").text()+b.attr("data-option-display-value");d.val(b.attr("data-option-value")),this.$mood_remove.show(),e.hide(),this.mood_selected=[f,g],this.can_submit=!0,this.$postbox.on_change()},c.prototype.remove_mood=function(){jQuery("span#postmood",this.$postbox.$textarea.parent()).remove(),jQuery("#postbox-mood-input",this.$postbox).val(""),this.$mood_remove.hide(),this.$mood.hide(),this.mood_selected=!1,this.can_submit=!1,this.$postbox.on_change()},c.prototype.set_mood=function(a){return void 0===a.mood&&(a.mood=""),a.mood=jQuery("#postbox-mood-input",this.$postbox).val(),a},ps_observer.add_filter("peepso_postbox_addons",function(a){return a.push(new c),a},10,1)}()}(jQuery||$,peepso);
//# sourceMappingURL=bundle.min.js.map